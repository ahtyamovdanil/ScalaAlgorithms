1) Нужно считать данные, проигнорировав одинаковые числа, после чего вывести в нужном формате.
Для вывода удобно создать буфер под каждую строку и выводить в него, поддерживая общий сдвиг по горизонтали.

2) Считываем, идем по лабиринту, помечая посещенные вершины, когда приходим в посещенную вершину или выход,
выводим цикл или сообщение о его отсутствии соответственно.

3) Решение:
   Заметим, что с увеличением числа квартир, число нажатий каждой из клавиш не
   уменьшается. То есть в этой задаче можно применить бинпоиск по ответу. Осталось
   научиться проверять количество нажатий при фиксированном количестве квартир,
   что не сложно.